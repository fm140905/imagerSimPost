dum1 file: 

       627    47    2    0    53         80   0.307570          128427538.438635     2.74    4.58   -0.23  1.000E+00    3     1    3 3.076E-01
      1193     5    2    1    53         20   0.509869          394564300.679229     0.61    4.40    0.56  1.000E+00    0     1    0 1.377E+00
      2211     4    2    1    53        404   1.214052           16372027.771505     6.17    1.88    1.13  1.000E+00    0     0    0 1.433E+00
      2211     4    2    1    53        404   0.019458           16372027.771564     6.15    1.88    1.13  1.000E+00    0     1    0 2.193E-01
      2211     4    2    0    55        303   0.199857           16372027.773708     5.60    1.65    1.37  1.000E+00    0     2    0 1.999E-01
      2915    19    2    1    55         96   0.252220          309114075.142768     3.78    2.81    0.67  1.000E+00    1     0   54 4.179E-01
      2915    19    2    0    55         96   0.165710          309114075.143050     3.74    2.82    0.74  1.000E+00    1     1   54 1.657E-01
      3125     3    2    1    55         74   0.565546           86881719.188648     2.61    1.74    0.44  1.000E+00    0     0    0 1.916E+00
      3125     3    2    1    55        204   0.953549           86881719.194809     4.22    1.77   -0.47  1.000E+00    0     1    0 1.351E+00
      3125     3    2    1    53        204   0.228093           86881719.196479     4.05    2.03   -0.86  1.000E+00    0     2    0 3.970E-01

history_No   pid gamma reac target   cell    E_deposited        time       x       y       z      weight     /   nsca   /  erg_par_in(MeV)
        21     1  2    1    55         35   0.228927             0.04     0.84    2.26   -0.16  1.000E+00    0     0    0 6.610E-01
        21     1  2    1    55         35   0.199572             0.04     1.11    2.57   -0.04  1.000E+00    0     1    0 4.220E-01
        21     1  2    3    55         35   0.186618             0.04     1.42    2.27   -0.11  1.000E+00    0     2    0 2.224E-01
        21     1  2    3    53         35   0.035813             0.04     1.42    2.27   -0.11  1.000E+00    0     2    0 3.581E-02
        21     2  2    3    53         35   0.010071             0.04     0.84    2.26   -0.16  1.000E+00    0     1    0 1.007E-02
        48     1  2    1    55         56   0.429851             0.04     1.76    2.62   -0.05  1.000E+00    0     0    0 6.610E-01
        48     1  2    1    55         55   0.073002             0.04     1.95    2.45    0.11  1.000E+00    0     1    0 2.096E-01
        48     1  2    3    55         55   0.105975             0.04     1.96    2.46    0.07  1.000E+00    0     2    0 1.366E-01
        48     1  2    3    55         55   0.030622             0.04     1.97    2.46    0.08  1.000E+00    0     2    0 3.062E-02
        48     3  2    3    55         56   0.013385             0.04     1.76    2.62   -0.05  1.000E+00    0     1    0 1.338E-02
        48     2  2    3    55         56   0.008165             0.04     1.76    2.62   -0.05  1.000E+00    0     1    0 8.165E-03
        51     1  2    1    53         74   0.050400             0.04     2.86    1.86    0.28  1.000E+00    0     1    0 6.281E-01
        54     1  2    1    55        307   0.358192             0.04     5.11    3.38    0.52  1.000E+00    0     0    0 6.610E-01
        54     1  2    1    53         98   0.094290             0.05     3.31    3.82   -0.28  1.000E+00    0     1    0 3.028E-01
        54     1  2    3    53         77   0.179909             0.05     2.91    3.41    0.01  1.000E+00    0     2    0 2.085E-01
        54     1  2    3    55         77   0.028609             0.05     2.90    3.40    0.00  1.000E+00    0     2    0 2.861E-02
        59     1  2    1    53        604   0.108711             0.04     7.30    2.09    1.47  1.000E+00    0     0    0 6.610E-01
        64     1  2    1    55        611   0.099624             0.05     7.21    5.02   -0.33  1.000E+00    0     1    0 6.588E-01
        67     1  2    1    55         53   0.186788             0.04     2.16    1.40   -0.55  1.000E+00    0     0    0 6.610E-01
        67     1  2    1    55         53   0.304438             0.04     2.18    1.67   -0.86  1.000E+00    0     1    0 4.742E-01

  99999939     2  2    3    53         14   0.001967             0.04     0.23    1.79   -0.98  1.000E+00    0     1    0 1.967E-03
  99999970     1  2    1    55         33   0.038245             0.04     0.83    1.69   -0.24  1.000E+00    0     0    0 6.610E-01
  99999970     1  2    3    53         16   0.591504             0.04     0.49    2.65    0.05  1.000E+00    0     1    0 6.228E-01
  99999970     1  2    3    55         16   0.028609             0.04     0.50    2.65    0.06  1.000E+00    0     1    0 2.861E-02
  99999970     2  2    3    53         16   0.002642             0.04     0.49    2.65    0.05  1.000E+00    0     1    0 2.642E-03
  99999988     1  2    1    55         39   0.472426             0.05     1.01    3.91   -1.14  1.000E+00    0     0    0 6.610E-01
  99999988     1  2    3    55         37   0.155694             0.05     1.06    3.28   -0.93  1.000E+00    0     1    0 1.867E-01
  99999988     1  2    3    53         37   0.030979             0.05     1.08    3.26   -0.92  1.000E+00    0     1    0 3.098E-02
  99999988     2  2    3    53         39   0.001901             0.05     1.01    3.91   -1.14  1.000E+00    0     1    0 1.901E-03
  99999990     1  2    1    55        604   0.202758             0.04     8.00    1.72   -0.13  1.000E+00    0     0    0 6.610E-01

    119449     1  2    1    55         78   0.165062             0.05     2.40    3.58    0.68  1.000E+00    0     0    0 6.610E-01
    119449     2  2    3    53         58   0.034704             0.05     2.40    3.58    0.68  1.000E+00    0     1    0 3.470E-02

         26.               0.50000000      2.             119449.            0.030964      3.      2.   -999.           0.10000000E+01          58               0.03470000
         36.               0.50000000      2.             119449.            0.157417      1.      1.   -999.           0.10000000E+01          78               0.66100001

All_pulses.o
                             time(ns)   pulse_type     history_No   pulse_height(MeV)   reac.                            weight             cell              erg_par_in(MeV)
         13.               0.40000000      2.                 21.            0.737400      1.      1.   -999.           0.10000000E+01          35               0.66100001
         23.               0.40000000      2.                 48.            0.215864      3.      1.   -999.           0.10000000E+01          55               0.03062000
         24.               0.40000000      2.                 48.            0.452731      1.      1.   -999.           0.10000000E+01          56               0.66100001
         32.               0.40000000      2.                 51.            0.046661      1.      1.   -999.           0.10000000E+01          74               0.62809998
         65.               0.40000000      2.                 54.            0.362661      1.      1.   -999.           0.10000000E+01         307               0.66100001
         46.               0.50000000      2.                 54.            0.083879      1.      1.   -999.           0.10000000E+01          98               0.30280000
         35.               0.50000000      2.                 54.            0.207987      3.      1.   -999.           0.10000000E+01          77               0.20850000
         92.               0.40000000      2.                 59.            0.103136      1.      1.   -999.           0.10000000E+01         604               0.66100001
         99.               0.50000000      2.                 64.            0.102308      1.      1.   -999.           0.10000000E+01         611               0.65880001
         21.               0.40000000      2.                 67.            0.503015      1.      1.   -999.           0.10000000E+01          53               0.66100001
         71.               0.40000000      2.                 69.            0.253910      1.      1.   -999.           0.10000000E+01         403               0.66100001
         82.               0.40000000      2.                 69.            0.390592      1.      1.   -999.           0.10000000E+01         504               0.39390001
         72.               0.40000000      2.                 86.            0.172977      1.      1.   -999.           0.10000000E+01         404               0.50120002
         62.               0.50000000      2.                 86.            0.341322      3.      1.   -999.           0.10000000E+01         304               0.33640000
         57.               0.50000000      2.                 95.            0.022789      1.      1.   -999.           0.10000000E+01         209               0.66100001
         58.               0.50000000      2.                 95.            0.631979      3.      1.   -999.           0.10000000E+01         210               0.02831000
         17.               0.50000000      2.                 97.            0.004313      1.      1.   -999.           0.10000000E+01          39               0.66100001
         19.               0.50000000      2.                 97.            0.351328      1.      1.   -999.           0.10000000E+01          41               0.65170002
         20.               0.50000000      2.                 97.            0.295631      1.      1.   -999.           0.10000000E+01          42               0.47999999
         37.               0.50000000      2.                100.            0.207598      3.      2.   -999.           0.10000000E+01          79               0.00400000

         31.               0.40000000      2.           89765558.            0.134197      1.      1.   -999.           0.10000000E+01          73               0.27219999
         41.               0.40000000      2.           89765558.            0.385267      1.      1.   -999.           0.10000000E+01          93               0.66100001
         42.               0.40000000      2.           89765558.            0.143121      3.      1.   -999.           0.10000000E+01          94               0.13689999
         79.               0.50000000      2.           89765559.            0.133292      1.      1.   -999.           0.10000000E+01         411               0.13230000
         87.               0.50000000      2.           89765559.            0.540202      1.      1.   -999.           0.10000000E+01         509               0.66100001
         97.               0.50000000      2.           89765569.            0.414940      1.      1.   -999.           0.10000000E+01         609               0.66100001
         21.               0.40000000      2.           89765585.            0.466388      1.      1.   -999.           0.10000000E+01          53               0.60430002
         22.               0.40000000      2.           89765585.            0.114611      3.      1.   -999.           0.10000000E+01          54               0.11270000
         50.               0.50000000      2.           89765590.            0.098971      1.      1.   -999.           0.10000000E+01         102               0.66100001
         92.               0.40000000      2.           89765608.            0.675097      1.      1.   -999.           0.10000000E+01         604               0.66100001

         54.     99999979198.31918335      2.           85965777.            0.224839      1.      1.   -999.           0.10000000E+01         206               0.66100001
to reconstruct an event, we need first and second interaction sites, and scattering angle
1. assume initial energy is known as 0.661MeV. we only need to know the energy deposited in the first cell; thus we can select 1-->3 or 1-->1 event pairs. the scattering angle is:

    cos(\theta) = 1 - E_d1 * mc^2 / (0.661 * (0.661-E_d1))

2. if the initial energy is unknown, we select 1-->3 event pairs, i.e., photon deposits all its energt in second cell. the scattering angle is:

    cos(\theta) = 1 - E_d1 * mc^2 / ((E_d1+E_d2) * E_d2)


while histNo < max:
    get pulses with same history number
    if number of pulse != 2:
        go to next hist number
    else:
        parse line
        sort pulses by erg_par_in
        if interaction of second pulse is not 3:
            go to next hist number
        calculate scattering angle
        get interaction sites from dum1 file, based on history number and cell number:
            select all interactions with the same history number
            sort by cell number
            pick up the one with the mathching cell number and max energy of all

how do we know whether the photon deposits all its energy in the second interaction? 
Simulation shows that there are many multiple scattering events.
    